# 专注学习计时器项目文档

## 1. 项目背景

专注学习计时器是一款基于番茄工作法的桌面应用程序，旨在帮助用户提高学习效率和时间管理能力。项目采用Python和PyQt5开发，提供了友好的图形界面和丰富的功能特性。

## 2. 需求分析

### 2.1 核心需求

* **单实例运行**：确保应用程序在Windows系统中只运行一个实例
* **计时功能**：支持标准番茄钟（25分钟工作+5分钟休息）和自定义时长
* **数据统计**：记录和展示用户的学习时间数据
* **系统集成**：支持系统托盘、通知提醒等Windows原生特性

### 2.2 扩展需求

* **个性化设置**：自定义提醒音效、界面主题等
* **数据导出**：支持学习记录的导出和备份
* **多语言支持**：预留国际化接口

## 3. 技术架构

### 3.1 开发环境

* **操作系统**：Windows 10/11
* **Python版本**：3.13
* **主要依赖**：
  - PyQt5：GUI框架
  - SQLite3：数据存储
  - Matplotlib：数据可视化
  - Pygame：音频处理
  - PyInstaller：应用打包

### 3.2 项目结构

```
专注学习计时器
├── main.py              # 程序入口
├── config/             # 配置管理
│   ├── settings.py     # 设置管理
│   └── database.py     # 数据库管理
├── core/               # 核心功能
│   ├── singleton.py    # 单例实现
│   ├── timer.py        # 计时器逻辑
│   └── audio_manager.py # 音频管理
├── ui/                 # 界面组件
│   ├── main_window.py  # 主窗口
│   ├── timer_widget.py # 计时器界面
│   └── stats_widget.py # 统计界面
└── resources/          # 资源文件
    ├── icons/         # 图标资源
    └── sounds/        # 音效资源
```

## 4. 设计实现

### 4.1 单例模式

采用Windows原生消息机制实现单例模式，确保应用程序只运行一个实例：

* 使用命名互斥锁检测已运行实例
* 通过Windows消息（WM_SHOWAPP）激活已有窗口
* 实现原生事件过滤器处理窗口激活消息

### 4.2 界面设计

基于PyQt5实现现代化的用户界面：

* 主窗口采用QMainWindow作为基类
* 使用QStackedWidget实现页面切换
* 支持系统托盘和托盘菜单
* 实现高DPI缩放支持

### 4.3 数据管理

使用SQLite3实现数据持久化：

* 学习记录的存储和查询
* 用户设置的保存和加载
* 数据备份和恢复机制

### 4.4 音频系统

基于Pygame实现音频管理：

* 支持多种音频格式
* 音量控制和静音功能
* 自定义提醒音效

## 5. 已实现功能

### 5.1 核心功能

* ✅ Windows平台单例运行
* ✅ 标准番茄钟计时
* ✅ 自定义时长设置
* ✅ 学习数据统计
* ✅ 系统托盘集成

### 5.2 扩展功能

* ✅ 高DPI显示适配
* ✅ 自定义提醒音效
* ✅ 数据备份恢复
* ✅ 界面主题切换

### 5.3 开发工具

* ✅ PyInstaller打包脚本
* ✅ NSIS安装程序制作
* ✅ 开发环境配置文档

## 6. 未来规划

### 6.1 功能增强

* 🔲 云端数据同步
* 🔲 多语言本地化
* 🔲 统计报表导出
* 🔲 快捷键支持

### 6.2 性能优化

* 🔲 启动速度优化
* 🔲 内存占用优化
* 🔲 数据库性能优化

## 7. 开发指南

### 7.1 环境搭建

1. 安装Python 3.13
2. 创建虚拟环境
3. 安装依赖：`pip install -r requirements.txt`

### 7.2 开发流程

1. 克隆代码仓库
2. 配置开发环境
3. 运行测试用例
4. 提交代码审查

### 7.3 打包发布

1. 更新版本号
2. 运行打包脚本
3. 生成安装程序
4. 测试安装包